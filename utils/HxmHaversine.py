# -*- coding: utf-8 -*-
"""
Created on Fri Sep  7 15:28:18 2018
计算两个点（经纬度）之间的距离，已经与瑞思校区的最小距离。
@author: hxm
"""
from math import radians, cos, sin, asin, sqrt

class HxmHaversine:
    
    def haversine(self, lon1, lat1, lon2, lat2): # 经度1，纬度1，经度2，纬度2 （十进制度数）
        """
        Calculate the great circle distance between two points 
        on the earth (specified in decimal degrees)
        """
        # 将十进制度数转化为弧度
        lon1, lat1, lon2, lat2 = map(radians, [lon1, lat1, lon2, lat2])
        # haversine公式
        dlon = lon2 - lon1 
        dlat = lat2 - lat1 
        a = sin(dlat/2)**2 + cos(lat1) * cos(lat2) * sin(dlon/2)**2
        c = 2 * asin(sqrt(a)) 
        r = 6371 # 地球平均半径，单位为公里
        return c * r * 1000

    def rise_distance_min(self, lon1, lat1):#与瑞思校区（北上广深济南）的最小距离
        distances = []
        rise_lon_lat = [[116.424523,39.904704],[116.453539,39.898992],[116.361621,39.950279],[116.38059,39.903296],[116.331207,39.88919],[116.404109,39.975352],[116.424608,40.039646],[116.607636,39.930834],[116.523246,39.934098],[116.471641,39.871294],[116.448742,39.964621],[116.473557,39.940157],[116.46327,40.00028],[116.42246,40.009527],[116.247654,39.909968],[116.431416,39.872535],[116.375056,39.836485],[116.404151,39.861409],[116.340481,39.990223],[116.29497,39.965018],[116.318371,39.915334],[116.323045,40.040979],[116.314005,39.988811],[116.513378,39.818211],[116.495333,39.802422],[116.691304,39.887686],[116.659867,39.913459],[116.644498,39.911417],[116.672076,39.88601],[116.331542,39.796171],[116.327752,39.691845],[116.429122,39.826081],[116.325883,40.081787],[116.422602,40.066107],[116.313101,40.073818],[116.255438,40.213646],[116.216969,39.768302],[116.148225,39.740926],[116.844851,40.374487],[116.636908,40.320531],[116.653219,40.130082],[116.117798,39.940911],[116.374702,39.820197],[117.659469,39.025268],[117.23647,39.064632],[117.201024,39.125052],[117.190773,39.135271],[117.712191,39.035943],[117.178037,39.10557],[117.231771,39.144595],[117.690716,39.021212],[121.474753,31.212506],[121.44888,31.194584],[121.524748,31.307258],[121.583194,31.259971],[121.565285,31.232618],[121.525484,31.234994],[121.607917,31.210507],[121.384141,31.113957],[121.405825,31.136692],[121.37031,31.136966],[121.447188,31.248574],[121.491382,31.258664],[121.468916,30.936462],[121.368534,31.367346],[121.38502,31.16287],[121.423316,31.225224],[121.432687,31.286518],[121.261261,31.336351],[106.574897,29.531886],[106.554253,29.64734],[106.520606,29.613213],[106.524916,29.521236],[106.547654,29.585768],[106.517505,29.545037],[106.598905,29.589661],[106.477342,29.62736],[106.55061,29.404902],[117.173541,35.086564],[122.125354,37.514599],[117.062188,36.658754],[117.009856,36.668828],[117.018287,36.625713],[117.090057,36.648278],[116.979143,36.644872],[120.432918,36.16605],[120.471738,36.113194],[118.360935,35.057862],[117.14347,36.204708],[116.611675,35.436258],[121.402029,37.533617],[121.261681,37.544878],[118.06799,36.808109],[118.038286,36.847768],[118.00525,36.852555],[118.673731,37.449645],[120.308132,31.576884],[120.310114,31.493984],[118.828818,31.931456],[118.852039,32.034363],[118.738788,31.999155],[118.800805,31.998496],[118.816233,32.091558],[118.929336,32.106889],[118.992494,32.127697],[120.629193,30.908285],[120.631745,31.299506],[120.718043,31.325104],[120.573786,31.303609],[120.645814,31.169413],[120.673479,31.327325],[120.556133,31.307101],[120.730567,31.295167],[120.753457,31.313506],[116.440432,32.397554],[119.383639,32.389349],[119.406233,32.374379],[119.58428,32.411924],[119.842859,31.364395],[119.469708,32.223227],[119.497294,32.200805],[119.441042,32.201156],[119.812035,32.240175],[120.76052,31.676334],[120.30306,31.928965],[120.174467,33.35427],[119.961044,31.792565],[120.836707,32.046778],[120.869478,32.038008],[120.900446,31.977365],[120.84034,32.042725],[117.158327,34.268136],[119.922166,32.478114],[117.242463,31.899737],[117.240571,31.824726],[117.26629,31.85787],[117.285349,31.883951],[117.212077,31.85914],[117.290587,31.727525],[117.160992,31.858244],[118.376225,31.342354],[115.829476,32.879186],[117.824013,30.934421],[118.512199,31.661403],[120.136887,30.271198],[120.175751,30.270576],[120.215506,30.213054],[120.113849,30.305226],[120.257995,30.188996],[120.210174,30.265815],[120.174491,30.275889],[120.173794,30.191677],[120.046104,30.251166],[120.308616,30.40161],[120.213383,30.270021],[120.676352,28.027043],[120.714668,28.007072],[120.583555,29.992565],[121.380866,28.59452],[118.854953,28.980955],[120.081496,29.317055],[120.238234,29.269047],[120.105593,30.880297],[120.273548,29.711509],[120.76421,30.745611],[118.605653,24.888065],[118.580392,24.825185],[119.28152,26.042362],[119.338631,26.097809],[119.304968,26.093429],[119.318957, 26.136287],[118.098676,24.469916],[118.179417,24.492237],[113.3965,22.513344],[113.336261,23.123936],[113.278285,23.137942],[113.337082,23.139864],[113.303142,23.134581],[113.302572,23.108614],[113.334735,23.098105],[113.355513,23.012264],[113.235901,23.138514],[113.3179,23.125134],[113.212661,23.163619],[114.019556,22.556729],[113.954948,22.522684],[114.03535,22.632333],[114.054871,22.553875],[114.118522,22.546098],[114.083254,22.728774],[114.141281,22.575332],[114.057089,22.521026],[114.13817,22.598926],[114.033883,22.655447],[113.16071,23.043184],[111.992703,21.877705],[113.760385,23.01299],[113.536832,22.266593],[113.522219,22.237316],[113.586104,22.281843],[114.417541,23.074814],[110.428167,21.22319],[110.398268,21.273869],[110.406265,21.216652],[116.75582,23.373496],[108.400865,22.816583],[110.325877,20.033565],[110.355819,20.06318],[110.381178,20.025238],[110.261675,20.030732],[114.35565,30.590486],[114.31736,30.613049],[114.331185,30.509917],[114.404666,30.512989],[114.273776,30.555324],[114.281136,30.586022],[114.244409,30.655807],[114.34676,30.55894],[114.214109,30.564533],[114.174287,30.623508],[114.213097,30.510687],[114.382146,30.631137],[114.327349,30.370513],[114.296373,30.706582],[114.312405,30.657207],[110.792509,32.658489],[112.159868,32.049322],[112.142468,32.016222],[111.312552,30.688551],[114.920024,30.397337],[113.964256,30.910588],[113.3782,31.72797],[114.909562,30.465709],[115.066357,30.249659],[113.109234,29.360128],[112.869052,28.20648],[112.977085,28.205498],[113.053723,28.161316],[113.082739,28.234781],[113.130772,27.824679],[112.946253,27.833881],[114.67106,35.206506],[113.612806,34.769045],[113.698849,34.790328],[113.72501,34.727529],[113.608295,34.752508],[115.864397,28.63867],[115.874692,28.70724],[114.480012,38.054493],[114.5412,38.030905],[114.5124,38.050571],[114.56884,38.029128],[114.54045,38.02009],[114.5097,36.629761],[119.6008,39.948246],[116.802,39.953515],[116.828404,39.970493],[118.160667,39.637604],[116.717104,39.539375],[116.685044,39.548747],[116.683076,39.519719],[117.941901,40.971802],[115.476353,38.882356],[114.900781,40.804535],[116.825079,38.30594],[116.88555,38.286903],[116.294504,39.463979],[113.10408,36.183379],[113.127929,36.210576],[112.557635,37.881938],[112.563969,37.824391],[112.577535,37.781193],[111.028597,35.0454],[113.324222,40.088557],[111.7411,40.842647],[118.896069,42.259234],[106.261984,38.519239],[87.58723,43.888811],[87.614582,43.810399],[101.72613,36.647568],[101.811359,36.616153],[108.980081,34.275736],[108.960157,34.204123],[108.893635,34.251097],[108.889287,34.18865],[108.98163,34.213967],[107.023368,33.073896],[107.236772,34.350861],[104.778017,29.338929],[104.416506,31.12538],[104.420748,31.166382],[104.073257,30.608003],[104.182154,30.820894],[103.859108,30.68683],[104.063629,30.68019],[104.201525,30.580253],[104.102436,30.628571],[104.01524,30.676611],[104.111329,30.685651],[104.017018,30.716391],[104.159981,30.632497],[104.072038,30.595463],[104.052021,30.709334],[104.071738,30.574918],[104.074935,30.71809],[104.062997,30.506012],[104.026803,30.656164],[104.007361,30.643035],[104.14956,30.68548],[104.046401,30.705657],[103.934077,30.60158],[104.007542,30.668307],[104.017664,30.632336],[104.076911,30.610399],[104.103181,30.626526],[104.0106,30.727425],[103.890286,30.6858],[104.760836,31.465045],[104.705519,31.504701],[104.713177,31.491862],[103.840145,30.072487],[103.692393,30.629019],[103.758019,29.589833],[107.476299,31.212866],[103.913762,30.814054],[104.294146,30.973979],[106.092453,30.778238],[103.636962,30.987848],[105.414248,28.90052],[105.602461,30.536969],[105.884287,32.430514],[102.715716,25.040289],[102.692124,25.006383],[102.740939,25.088294],[102.755478,24.960003],[106.721859,26.602131],[106.722503,26.577794],[122.1037,41.142548],[121.61741,38.915454],[121.604254,39.003682],[123.795707,41.303564],[123.432791,41.808645],[123.422943,41.836337],[123.470656,41.814801],[123.437543,41.761547],[123.382747,41.798415],[123.46937,41.803517],[121.140374,41.094593],[121.165843,41.119114],[123.236278,41.278824],[120.842098,40.724753],[123.071799,41.123231],[123.843479,42.296313],[122.121967,40.228157],[125.345207,43.847737],[125.312746,43.870042],[125.250886,43.841502],[125.370803,43.820963],[126.63297,45.781746],[126.703,45.763425],[124.891327,46.639396]]
        for rise in rise_lon_lat:
            lon = rise[0]
            lat = rise[1]
            distance = self.haversine(lon1, lat1, lon, lat)
            distances.append(distance)
        min_distance = min(distances)
        return min_distance
